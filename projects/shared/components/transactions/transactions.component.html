<div class="mat-subtitle-1 thin" style="text-align: center">Transactions</div>
<mat-form-field>
  <mat-label>Search</mat-label>
  <input matInput (keyup)="applyFilter($event)" placeholder="i.e. Visa" #input>
</mat-form-field>

<table mat-table matSort [dataSource]="dataSource" multiTemplateDataRows class="mat-elevation-z8">
  <ng-container matColumnDef="timestamp">
    <th mat-header-cell *matHeaderCellDef class="date">Date</th>
    <td mat-cell *matCellDef="let tx" class="date"> {{ tx.timestamp | date: xSmall ? 'MMM d' : 'short' }}</td>
  </ng-container>
  <ng-container matColumnDef="type">
    <th mat-header-cell *matHeaderCellDef class="type">Type</th>
    <td mat-cell *matCellDef="let tx" class="type"><strong>{{ tx.type | titlecase}}</strong></td>
  </ng-container>
  <ng-container matColumnDef="from" *ngIf="!xSmall">
    <th mat-header-cell *matHeaderCellDef class="party">Counterparty</th>
    <td mat-cell *matCellDef="let tx" class="party">{{ getParty(tx) }}</td>
  </ng-container>
  <ng-container matColumnDef="balance">
    <th mat-header-cell *matHeaderCellDef class="balance">Balance</th>
    <td mat-cell *matCellDef="let tx" class="balance">
      {{ tx.balance.amount | number: '1.2-6' }} <span class="tag">{{ tx.balance.currency }}</span>
    </td>
  </ng-container>
  <ng-container matColumnDef="expand">
    <th mat-header-cell *matHeaderCellDef aria-label="row actions" style="padding: 0 4px;">&nbsp;</th>
    <td mat-cell *matCellDef="let element" style="padding: 0 4px;">
      <button mat-icon-button aria-label="expand row"
              (click)="(expandedElement = expandedElement === element ? null : element); $event.stopPropagation()">
        <mat-icon *ngIf="expandedElement !== element">keyboard_arrow_down</mat-icon>
        <mat-icon *ngIf="expandedElement === element">keyboard_arrow_up</mat-icon>
      </button>
    </td>
  </ng-container>

  <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
  <ng-container matColumnDef="expandedDetail">
    <td mat-cell *matCellDef="let tx" [attr.colspan]="columnsToDisplayWithExpand.length">
      <div class="element-detail full" [@detailExpand]="tx == expandedElement ? 'expanded' : 'collapsed'">
        <div class="one-third">
          <div class="mat-caption">
            <p>
              <strong>Tx Type:</strong>
              <span>{{ tx.type }}</span>
            </p>
            <p>
              <strong>From:</strong>
              <span>{{tx.from}}</span>
              <span class="tag" *ngIf="tx.from === tag">you</span>
            </p>
            <p>
              <strong>To:</strong>
              <span>{{ tx.to }}&nbsp;</span>
              <span class="tag grey" *ngIf="tx.to === tag">you</span>
            </p>
            <p>
              <strong>Balance:</strong>
              <span>
                {{ tx.balance.amount | number: '1.2-6' }} <span class="tag grey">{{ tx.balance.currency }}</span>
              </span>
            </p>
          </div>
        </div>
        <div class="one-third">
          <div
            class="stamp"
            [ngClass]="[xSmall ? 'right' : '', tx.status]"
            [style.color]="getColor(tx.status)">
            {{ tx.status }}
          </div>
        </div>
        <div class="one-third">
          <span class="date right">{{ tx.timestamp | date: xSmall ? 'medium' : 'full' }}</span>
          <span class="id right full">{{ tx.id }}</span>
        </div>

        <mat-divider></mat-divider>
        <div *ngIf="tx.fromAddress" class="mat-caption xrpl">
          <strong>Sender:</strong>
          <span>{{ xSmall ? tx.fromAddress.slice(0, 6) + '•••' + tx.fromAddress.slice(-6) : tx.fromAddress }}</span>
        </div>
        <div *ngIf="tx.toAddress" class="mat-caption xrpl">
          <strong>Receiver:</strong>
          <!--          <span>{{ tx.toAddress }}</span>-->
          <span>{{ xSmall ? tx.toAddress.slice(0, 6) + '•••' + tx.toAddress.slice(-6) : tx.toAddress }}</span>

        </div>
        <div *ngIf="tx.hash" class="mat-caption xrpl hash">
          <strong>Hash:</strong>
          <span>{{ xSmall ? tx.hash.slice(0, 6) + '•••' + tx.hash.slice(-6) : tx.hash }}</span>
          <lib-copy-button [clipboardText]="tx.hash"></lib-copy-button>
        </div>
        <div *ngIf="tx.memo" class="memo">
          <strong>Memo:</strong>
          <span>{{ tx.memo }}</span>
        </div>
      </div>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="columnsToDisplayWithExpand" class="element-header"></tr>
  <tr mat-row *matRowDef="let element; let index = dataIndex; columns: columnsToDisplayWithExpand;"
      class="element-row"
      [style.background-color]=" index % 2 === 0 ? 'var(--color-greye)':'var(--color-greyd)'"
      [class.expanded-row]="expandedElement === element"
      (click)="expandedElement = expandedElement === element ? null : element">
  </tr>
  <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="detail-row"></tr>
</table>
<mat-paginator [pageSizeOptions]="[7, 15, 50]"></mat-paginator>
